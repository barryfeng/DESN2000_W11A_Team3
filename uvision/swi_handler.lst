


ARM Macro Assembler    Page 1 


    1 00000000                 AREA             IRQ, CODE
    2 00000000                 PRESERVE8
    3 00000000         
    4 00000000                 EXPORT           SWI_Handler
    5 00000000         
    6 00000000 82000000 
                       STA_MEM2_BASE
                               EQU              0x82000000
    7 00000000 00000005 
                       SWI_NUM EQU              5
    8 00000000         
    9 00000000 00000014 
                       VEL_BYTES
                               EQU              20
   10 00000000 0000000C 
                       VEL_SET_BYTES
                               EQU              12
   11 00000000 00000004 
                       BRAKE_BYTES
                               EQU              4
   12 00000000 00000002 
                       DMS_BYTES
                               EQU              2
   13 00000000         
   14 00000000         SWI_Handler
   15 00000000 E3A05482        LDR              R5, =STA_MEM2_BASE ; static mem
                                                            ory bank 2
   16 00000004 E5956000        LDR              R6, [R5]
   17 00000008         
   18 00000008 E51EC004        LDR              IP, [LR, #-4] ; Load SWI to IP
   19 0000000C E3CCC4FF        BIC              IP, IP, #0XFF000000 ; Clear top
                                                             8 bits of IP
   20 00000010         
   21 00000010 E35C0005        CMP              IP, #SWI_NUM ; Check function i
                                                            ndex is in range
   22 00000014 379FF10C        LDRLO            PC, [PC, IP, LSL #2] ; Branch t
                                                            o correct handler
   23 00000018         
   24 00000018 EA00001A        B                SWI_OUT_OF_RANGE
   25 0000001C         
   26 0000001C         SWI_JUMP_TABLE                       ; jump table
   27 0000001C 00000000        DCD              SWI_store
   28 00000020 00000000        DCD              SWI_view_vel
   29 00000024 00000000        DCD              SWI_view_vel_setpoint
   30 00000028 00000000        DCD              SWI_view_brake
   31 0000002C 00000000        DCD              SWI_view_dms
   32 00000030         
   33 00000030         ; NOTE: registers R0-R3 contain the data to be stored
   34 00000030         
   35 00000030 E926000F 
                       SWI_store
                               STMFD            R6!, {R0-R3} ; load data into m
                                                            emory and update ba
                                                            se register after t
                                                            ransfer
   36 00000034         
   37 00000034 EA000014        B                SWI_EXIT
   38 00000038         
   39 00000038 E3A07014 



ARM Macro Assembler    Page 2 


                       SWI_view_vel
                               MOV              R7, #VEL_BYTES
   40 0000003C E0458007        SUB              R8, R5, R7  ; go back VEL_BYTES
                                                             in memory to get t
                                                            o location of veloc
                                                            ity 
   41 00000040 E5987000        LDR              R7, [R8]    ; load word (veloci
                                                            ty)
   42 00000044 E1A00007        MOV              R0, R7      ; return velocity  
                                                                
   43 00000048         
   44 00000048 EA00000F        B                SWI_EXIT
   45 0000004C         
   46 0000004C         SWI_view_vel_setpoint
   47 0000004C E3A0700C        MOV              R7, #VEL_SET_BYTES
   48 00000050 E0458007        SUB              R8, R5, R7  ; go back VEL_SET_B
                                                            YTES in memory to g
                                                            et to location of v
                                                            elocity setpoint
   49 00000054 E5987000        LDR              R7, [R8]    ; load word (veloci
                                                            ty set point)
   50 00000058 E1A00007        MOV              R0, R7      ; return velocity s
                                                            et point      
   51 0000005C         
   52 0000005C EA00000A        B                SWI_EXIT
   53 00000060         
   54 00000060 E3A07004 
                       SWI_view_brake
                               MOV              R7, #BRAKE_BYTES
   55 00000064 E0458007        SUB              R8, R5, R7  ; go back BRAKE_BYT
                                                            ES in memory to get
                                                             to location of bra
                                                            ke state 
   56 00000068 E5D87000        LDRB             R7, [R8]    ; load byte (brake 
                                                            state)
   57 0000006C E1A00007        MOV              R0, R7      ; return brake stat
                                                            e      
   58 00000070         
   59 00000070 EA000005        B                SWI_EXIT
   60 00000074         
   61 00000074 E3A07002 
                       SWI_view_dms
                               MOV              R7, #DMS_BYTES
   62 00000078 E0458007        SUB              R8, R5, R7  ; go back DMS_BYTES
                                                             in memory to get t
                                                            o location of DMS s
                                                            tate 
   63 0000007C E5D87000        LDRB             R7, [R8]    ; load byte (DMS st
                                                            ate)
   64 00000080 E1A00007        MOV              R0, R7      ; return DMS state 
                                                                 
   65 00000084         
   66 00000084 EA000000        B                SWI_EXIT
   67 00000088         
   68 00000088         SWI_OUT_OF_RANGE
   69 00000088 E3E00000        MOV              R0, #-1     ; throw error
   70 0000008C         
   71 0000008C         SWI_EXIT
   72 0000008C E1B0F00E        MOVS             PC, LR      ; exit supervisor m



ARM Macro Assembler    Page 3 


                                                            ode
   73 00000090         
   74 00000090                 END
Command Line: --debug --xref --apcs=interwork --depend=.\swi_handler.d -o.\swi_
handler.o -IC:\Keil\ARM\RV31\Inc -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\Inc\
Philips --predefine="__EVAL SETA 1" --list=.\swi_handler.lst ..\logging\swi_han
dler.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

IRQ 00000000

Symbol: IRQ
   Definitions
      At line 1 in file ..\logging\swi_handler.s
   Uses
      None
Comment: IRQ unused
SWI_EXIT 0000008C

Symbol: SWI_EXIT
   Definitions
      At line 71 in file ..\logging\swi_handler.s
   Uses
      At line 37 in file ..\logging\swi_handler.s
      At line 44 in file ..\logging\swi_handler.s
      At line 52 in file ..\logging\swi_handler.s
      At line 59 in file ..\logging\swi_handler.s
      At line 66 in file ..\logging\swi_handler.s

SWI_Handler 00000000

Symbol: SWI_Handler
   Definitions
      At line 14 in file ..\logging\swi_handler.s
   Uses
      At line 4 in file ..\logging\swi_handler.s
Comment: SWI_Handler used once
SWI_JUMP_TABLE 0000001C

Symbol: SWI_JUMP_TABLE
   Definitions
      At line 26 in file ..\logging\swi_handler.s
   Uses
      None
Comment: SWI_JUMP_TABLE unused
SWI_OUT_OF_RANGE 00000088

Symbol: SWI_OUT_OF_RANGE
   Definitions
      At line 68 in file ..\logging\swi_handler.s
   Uses
      At line 24 in file ..\logging\swi_handler.s
Comment: SWI_OUT_OF_RANGE used once
SWI_store 00000030

Symbol: SWI_store
   Definitions
      At line 35 in file ..\logging\swi_handler.s
   Uses
      At line 27 in file ..\logging\swi_handler.s
Comment: SWI_store used once
SWI_view_brake 00000060

Symbol: SWI_view_brake
   Definitions
      At line 54 in file ..\logging\swi_handler.s
   Uses
      At line 30 in file ..\logging\swi_handler.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Comment: SWI_view_brake used once
SWI_view_dms 00000074

Symbol: SWI_view_dms
   Definitions
      At line 61 in file ..\logging\swi_handler.s
   Uses
      At line 31 in file ..\logging\swi_handler.s
Comment: SWI_view_dms used once
SWI_view_vel 00000038

Symbol: SWI_view_vel
   Definitions
      At line 39 in file ..\logging\swi_handler.s
   Uses
      At line 28 in file ..\logging\swi_handler.s
Comment: SWI_view_vel used once
SWI_view_vel_setpoint 0000004C

Symbol: SWI_view_vel_setpoint
   Definitions
      At line 46 in file ..\logging\swi_handler.s
   Uses
      At line 29 in file ..\logging\swi_handler.s
Comment: SWI_view_vel_setpoint used once
10 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

BRAKE_BYTES 00000004

Symbol: BRAKE_BYTES
   Definitions
      At line 11 in file ..\logging\swi_handler.s
   Uses
      At line 54 in file ..\logging\swi_handler.s
Comment: BRAKE_BYTES used once
DMS_BYTES 00000002

Symbol: DMS_BYTES
   Definitions
      At line 12 in file ..\logging\swi_handler.s
   Uses
      At line 61 in file ..\logging\swi_handler.s
Comment: DMS_BYTES used once
STA_MEM2_BASE 82000000

Symbol: STA_MEM2_BASE
   Definitions
      At line 6 in file ..\logging\swi_handler.s
   Uses
      At line 15 in file ..\logging\swi_handler.s
Comment: STA_MEM2_BASE used once
SWI_NUM 00000005

Symbol: SWI_NUM
   Definitions
      At line 7 in file ..\logging\swi_handler.s
   Uses
      At line 21 in file ..\logging\swi_handler.s
Comment: SWI_NUM used once
VEL_BYTES 00000014

Symbol: VEL_BYTES
   Definitions
      At line 9 in file ..\logging\swi_handler.s
   Uses
      At line 39 in file ..\logging\swi_handler.s
Comment: VEL_BYTES used once
VEL_SET_BYTES 0000000C

Symbol: VEL_SET_BYTES
   Definitions
      At line 10 in file ..\logging\swi_handler.s
   Uses
      At line 47 in file ..\logging\swi_handler.s
Comment: VEL_SET_BYTES used once
6 symbols
347 symbols in table
